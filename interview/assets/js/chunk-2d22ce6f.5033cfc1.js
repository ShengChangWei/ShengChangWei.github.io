(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22ce6f"],{f4e0:function(s,a,r){"use strict";r.r(a);var e=function(){var s=this,a=s.$createElement;s._self._c;return s._m(0)},t=[function(){var s=this,a=s.$createElement,r=s._self._c||a;return r("section",[r("h1",[s._v("一、原生实现的方法")]),r("blockquote",[r("p",[s._v("基本使用方法")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" promise = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n  "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ... some code")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* 异步操作成功 */")]),s._v("){\n    resolve(value);\n  } "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n    reject(error);\n  }\n});\n\npromise.then("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("value")]),s._v(") ")]),s._v("{\n  "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// success")]),s._v("\n}, "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("error")]),s._v(") ")]),s._v("{\n  "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// failure")]),s._v("\n});\n")])]),r("blockquote",[r("p",[s._v("思路解析")])]),r("ul",[r("li",[s._v("首先Promise是个构造函数")]),r("li",[s._v("MyPromise接收一个函数executor，executor有两个参数resolve方法和reject方法")]),r("li",[s._v("resolve将PENDING改变为FULFILLED")]),r("li",[s._v("reject将PENDING改变为FULFILLED")]),r("li",[s._v("promise变为FULFILLED状态后具有一个唯一的value")]),r("li",[s._v("promise变为REJECTED状态后具有一个唯一的reason")]),r("li",[s._v("then方法接受两个参数onFulfilled、onRejected，它们分别在状态由PENDING改变为FULFILLED、REJECTED后调用")]),r("li",[s._v("同步调用：状态已经改变，直接调用onFulfilled方法")]),r("li",[s._v("异步调用：状态还是PENDING，将onFulfilled、onRejected分别加入两个函数数组onFulfilledCallbacks、onRejectedCallbacks，当异步调用resolve和reject时，将两个数组中绑定的事件循环执行。")])]),r("blockquote",[r("p",[s._v("具体代码")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 手动实现promise")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" PENDING = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'pending'")]),s._v(";\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" FULFILLED = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fulfilled'")]),s._v(";\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" REJECTED = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'rejected'")]),s._v(";\n"),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("MyPromise")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("executor")]),s._v(") ")]),s._v("{\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".state = PENDING; "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 状态pending")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".value = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(";\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".reason = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(";\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".onFulfilledCallbacks = [];\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".onRejectedCallbacks = [];\n\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" resolve = "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("value")]),s._v(") =>")]),s._v(" {\n        "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".state === PENDING) {\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".state = FULFILLED;\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".value = value;\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".onFulfilledCallbacks.forEach("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("fun")]),s._v(" =>")]),s._v(" {\n                fun();\n            })\n        }\n    }\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" reject = "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("reason")]),s._v(") =>")]),s._v(" {\n        "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".state === "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'PENDING'")]),s._v(") {\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".state = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'REJECTED'")]),s._v(";\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".reason = reason;\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".onRejectedCallbacks.forEach("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("fun")]),s._v(" =>")]),s._v(" {\n                fun();\n            })\n        }\n    }\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("try")]),s._v(" {\n        executor(resolve, reject)\n    } "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("catch")]),s._v("(reason) {\n        reject(reason)\n    }\n    \n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// then的方法")]),s._v("\nMyPromise.prototype.then = "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("onFulfilled, onRejected")]),s._v(") ")]),s._v("{\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("switch")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".state) {\n        "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" FULFILLED:\n        onFulfilled("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".value);\n        "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v(";\n        "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" REJECTED:\n        onFulfilled("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".value);\n        "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v(";\n        "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("case")]),s._v(" PENDING:\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".onFulfilledCallbacks.push("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n                onFulfilled("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".value);\n            })\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".onRejectedCallbacks.push("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n                onRejected("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".value);\n            })\n            "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v(";\n    }\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" promise = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" MyPromise("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n        resolve("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'测试数据'")]),s._v(")\n})\npromise.then("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("res")]),s._v(") =>")]),s._v(" {\n    "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(res);\n})\n")])]),r("ul",[r("li",[s._v("未完待续")])]),r("p",[s._v("学习参考：")]),r("ul",[r("li",[r("p",[r("a",{attrs:{href:"http://es6.ruanyifeng.com/"}},[s._v("ECMAScript 6 入门")])])]),r("li",[r("p",[r("a",{attrs:{href:"https://github.com/ConardLi/awesome-coding-js"}},[s._v("用JavaScript实现的算法和数据结构，附详细解释和刷题指南")])])])])])}],l=r("2877"),n={},p=Object(l["a"])(n,e,t,!1,null,null,null);a["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d22ce6f.5033cfc1.js.map