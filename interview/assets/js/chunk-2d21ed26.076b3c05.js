(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21ed26"],{d6ca:function(s,a,t){"use strict";t.r(a);var r=function(){var s=this,a=s.$createElement;s._self._c;return s._m(0)},n=[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("h1",[s._v("命令模式")]),t("h2",[s._v("1、定义（学习模式不是目的，一定要了解其思想）")]),t("p",[s._v("命令模式: 是最简单和优雅的模式之一，指的是一个执行某些特定事情的指令。")]),t("p",[s._v("应用场景：有时候需要向某些对象发送请求，但是并不知道请求的接收者是谁，也不知道被请求的操作是什么 ，此时希望用一种松耦合的方式来设计程序，使得请求发送者和请求接收者能够消除彼此之间的耦合关系。")]),t("h2",[s._v("2、命令模式的例子——菜单程序")]),t("p",[s._v("代码如下：（了解即可, 太啰嗦）")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("body")]),s._v(">")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"button1"')]),s._v(">")]),s._v("点击按钮 1"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"button2"')]),s._v(">")]),s._v("点击按钮 2"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"button3"')]),s._v(">")]),s._v("点击按钮 3"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("body")]),s._v(">")]),s._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" button1 = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button1'")]),s._v(" ); \n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" button2 = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button2'")]),s._v(" );\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" button3 = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button3'")]),s._v(" );\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" setCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v(" button, command ")]),s._v(")")]),s._v("{ \n    button.onclick = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(")")]),s._v("{ \n        command.execute(); \n    } \n};\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" MenuBar = { \n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("refresh")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(")")]),s._v("{ \n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'刷新菜单目录'")]),s._v(" ); \n    } \n}; \n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" SubMenu = { \n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("add")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(")")]),s._v("{ \n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'增加子菜单'")]),s._v(" ); \n    }, \n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("del")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(")")]),s._v("{ \n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'删除子菜单'")]),s._v(" ); \n    } \n};\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" RefreshMenuBarCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v(" receiver ")]),s._v(")")]),s._v("{ \n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver = receiver; \n}; \nRefreshMenuBarCommand.prototype.execute = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(")")]),s._v("{ \n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver.refresh(); \n}; \n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" AddSubMenuCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v(" receiver ")]),s._v(")")]),s._v("{ \n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver = receiver; \n};\nAddSubMenuCommand.prototype.execute = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(")")]),s._v("{ \n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver.add(); \n}; \n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" DelSubMenuCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v(" receiver ")]),s._v(")")]),s._v("{ \n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver = receiver; \n}; \nDelSubMenuCommand.prototype.execute = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(")")]),s._v("{ \n    "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'删除子菜单'")]),s._v(" ); \n};\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" addSubMenuCommand = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" AddSubMenuCommand( SubMenu ); \n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" delSubMenuCommand = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" DelSubMenuCommand( SubMenu ); \nsetCommand( button1, refreshMenuBarCommand ); \nsetCommand( button2, addSubMenuCommand ); \nsetCommand( button3, delSubMenuCommand );\n")])]),t("h2",[s._v("3、JavaScript中的命令模式")]),t("p",[s._v("上述代码是模拟传统面向对象语言的命令模式实现，用闭包实现的命令模式如下代码所示：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" setCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("button , func")]),s._v(") ")]),s._v("{ "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 传入按钮，调用方法")]),s._v("\n    button.onclick = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        func();\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 命令模式的套路")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" MenuBar = { "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 一个对象有一个方法")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("refresh")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'刷新菜单页面'")]),s._v(");\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" RefreshMenuBarCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("receiver")]),s._v(") ")]),s._v("{ "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 返回一个方法")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        receiver.refresh();\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" refreshMenuBarCommand = RefreshMenuBarCommand(MenuBar);\n\nsetCommand(button1, refreshMenuBarCommand)\n\n")])]),t("p",[s._v("当然，如果想更明确地表达当前正在使用命令模式，或者除了执行命令之外，将来有可能还要提供撤销命令等操作，那我们最好还要把执行函数改为调用execute方法：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" RefreshMenuBarCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("receiver")]),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("execute")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n            receiver.refresh();\n        }\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" setCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("button, command")]),s._v(") ")]),s._v("{\n    button.onclick = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        command.execute();\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" refreshMenuBarCommand = RefreshMenuBarCommand(MenuBar);\nsetCommand(button1, refreshMenuBarCommand);\n")])]),t("h2",[s._v("4、撤销命令")]),t("p",[s._v("需求： 在"),t("code",{pre:!0},[s._v("input")]),s._v("中输入数值，点击运动按钮让小球运动到"),t("code",{pre:!0},[s._v("input")]),s._v("值的位置\n代码如下：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ball"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("style")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"position:absolute;background:#000;width:50px;height:50px"')]),s._v(">")]),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v(" \n输入小球移动后的位置："),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"pos"')]),s._v("/>")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"moveBtn"')]),s._v(">")]),s._v("开始移动"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v(" \n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ball = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ball'")]),s._v(" ); \n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" pos = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'pos'")]),s._v(" ); \n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" moveBtn = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'moveBtn'")]),s._v(" ); \nmoveBtn.onclick = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(")")]),s._v("{ \n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" animate = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Animate( ball );  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Animate 是一个动画js 传入值即可运动，了解作用就行")]),s._v("\n    animate.start( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'left'")]),s._v(", pos.value, "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'strongEaseOut'")]),s._v(" ); \n}; \n")])]),t("p",[s._v("现在希望有个撤回按钮，点击撤回小球回到上一次的位置")]),t("p",[s._v("在给页面添加撤销按钮之前，先把目前的代码改为用命令模式实现")]),t("p",[s._v("代码如下:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ball = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ball'")]),s._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" pos = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'pos'")]),s._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" moveBtn = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'moveBtn'")]),s._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" MoveCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("receiver, pos")]),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver = receiver;\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".pos = pos;\n};\n\nMoveCommand.prototype.execute = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver.start("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'left'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".pos, "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'strongEAseOut'")]),s._v(");\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" moveCommand;\n\nmoveBtn.onclick = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" animate = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Animate(ball);\n    moveCommand = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" MoveCommand(animate, pos.value);\n    moveCommand.execute();\n}\n")])]),t("p",[s._v("接下来增加撤销按钮：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ball"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("style")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"position:absolute;background:#000;width:50px;height:50px"')]),s._v(">")]),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v(" \n输入小球移动后的位置："),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"pos"')]),s._v("/>")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"moveBtn"')]),s._v(">")]),s._v("开始移动"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"cancelBtn"')]),s._v(">")]),s._v("cancel"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("cancel")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!--增加撤销按钮--\x3e")]),s._v(" \n")])]),t("p",[s._v("撤销操作的实现一般是给命令对象增加一个名为 unexecude 或者 undo 的方法，在该方法里执行 execute 的反向操作。在 command.execute 方法让小球开始真正运动之前，我们需要先记录小球的当前位置，在 unexecude 或者 undo 操作中，再让小球回到刚刚记录下的位置，代码如下：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ball = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ball'")]),s._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" pos = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementBy("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'pos'")]),s._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" moveBtn = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'moveBtn'")]),s._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" canceBtn = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'canceBtn'")]),s._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 面向对象开发")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" MoveCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("receiver, pos")]),s._v(") ")]),s._v("{ "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//receiver 将要传入animate方法， pos出入输入框的值")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver = receiver;\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".pos = pos;\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".oldPos = "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(";\n};\n\nMoveCommand.prototype.execute = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver.start("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'left'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".pos, "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'strongEAseOut'")]),s._v(");\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".oldPos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver.dom.getBoundingClientRect()["),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver.propertyName]; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 记录小球开始移动前的位置")]),s._v("\n};\n\nMoveCommand.prototype.undo = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".receiver.start("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'left'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".oldPos, "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'strongEaseOut'")]),s._v(");\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 回到小球移动前记录的位置")]),s._v("\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" moveCommand;\n\nmoveBtn.onclick = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" animate = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Animate(ball);\n    moveCommand = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" MoveCommand(animate, pos.value);\n    moveCommand.execute() "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 调用移动的方法")]),s._v("\n};\n\ncancelBtn.onclick = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n    moveCommand.undo(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 撤销命令")]),s._v("\n}\n\n")])]),t("h2",[s._v("5、撤销和重做")]),t("p",[s._v("我们把用户在键盘的输入都封装成命令， 执行过的命令将被存放到堆栈中。播放录像的时候只需要从头开始依次执行这些命令便可，代码如下：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("body")]),s._v(">")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"replay"')]),s._v(">")]),s._v("播放录像"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v(" \n "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("body")]),s._v(">")]),s._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" Ryu = {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("attack")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'攻击'")]),s._v(");\n    },\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("defense")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'防御'")]),s._v(")\n    },\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("jump")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'跳跃'")]),s._v(")\n    },\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("crouch")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'蹲下'")]),s._v(")\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" makeCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("receiver, state")]),s._v(") ")]),s._v("{ "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建命令")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        receiver[state]();\n    }\n};\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" commands = {\n    "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'119'")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'jump'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// W")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'115'")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'crouch'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// S")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'97'")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'defense'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// A")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'100'")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'attack'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// D")]),s._v("\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" commandStack = []; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 保存命令的堆栈")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".onkeypress = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("ev")]),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" keyCode = ev.keyCode,\n        command = makeCommand(Ryu, commands[keyCode]);\n    \n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(command) {\n        command(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 执行命令")]),s._v("\n        commandStack.push(command); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 将刚刚执行过的命令保存进堆栈")]),s._v("\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 点击回放按钮")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("document")]),s._v(".getElementById("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'replay'")]),s._v(").onclick = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" command;\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("while")]),s._v("(command = commandStack.shift()) { "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 从堆栈里一次取出命令并执行")]),s._v("\n        command();\n    }\n}\n")])]),t("h2",[s._v("6、宏命令")]),t("p",[s._v("宏命令是一组命令的集合，通过执行宏命令的方式，可以一次执行一批命令。想象一下，家里有一个万能遥控器，每天回家的时候，只要按一个特别的按钮，它就会帮我们关上房间门，顺便打开电脑并登录 QQ。")]),t("p",[s._v("下面我们看看如何逐步创建一个宏命令。首先，我们依然要创建好各种 Command：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" closeDoorCommand = {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("execute")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'关门'")]),s._v(")\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" openPcCommand = {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("execute")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'开电脑'")]),s._v(");\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" openQQCommand = {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("execute")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'登录QQ'")]),s._v(");\n    }\n};\n")])]),t("p",[s._v("接下来定义宏命令 MacroCommand， 它的结构也很简单。 macroCommand.add 方法表示把子命令添加进宏命令对象，当调用宏命令对象的 execute 方法时，会迭代这一组子命令对象，并且依次执行它们的 execute 方法：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" MacroCommand = "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("commandsList")]),s._v(": [],\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("add")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("command")]),s._v(") ")]),s._v("{\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".commandsList.push(command);\n        },\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("execute")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(",command; command = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".commandsList[i++];) {\n                command.execute();\n            }\n        }\n    }\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" macroCommand = MacroCommand();\n\nmacroCommand.add(closeDoorCommand);\nmacroCommand.add(openPcCommand);\nmacroCommand.add(openQQCommand);\n")])]),t("p",[s._v("当然我们还可以为宏命令添加撤销功能，跟 macroCommand.execute 类似，当调用macroCommand.undo 方法时，宏命令里包含的所有子命令对象要依次执行各自的 undo 操作。")]),t("h2",[s._v("7、智能命令与傻瓜命令")]),t("p",[s._v("再看一下上节创建的命令：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" closeDoorCommand = { \n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("execute")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(")")]),s._v("{ \n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log( "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'关门'")]),s._v(" ); \n    } \n}; \n")])]),t("p",[s._v("很奇怪，closeDoorCommand 中没有包含任何 receiver 的信息，它本身就包揽了执行请求的行为，这跟我们之前看到的命令对象都包含了一个 receiver 是矛盾的。  一般来说，命令模式都会在 command 对象中保存一个接收者来负责真正执行客户的请求，这种情况下命令对象是“傻瓜式”的，它只负责把客户的请求转交给接收者来执行，这种模式的好处是请求发起者和请求接收者之间尽可能地得到了解耦。")]),t("p",[s._v("但是我们也可以定义一些更“聪明”的命令对象， “聪明”的命令对象可以直接实现请求，这样一来就不再需要接收者的存在，这种“聪明”的命令对象也叫作智能命令。没有接收者的智能命令，退化到和策略模式非常相近，从代码结构上已经无法分辨它们，能分辨的只有它们意图的不同。策略模式指向的问题域更小，所有策略对象的目标总是一致的，它们只是达到这个目标的不同手段， 它们的内部实现是针对 “算法” 而言的。 而智能命令模式指向的问题域更广， command对象解决的目标更具发散性。命令模式还可以完成撤销、排队等功能。")]),t("h2",[s._v("8、小结")]),t("p",[s._v("本章我们学习了命令模式。跟许多其他语言不同，JavaScript 可以用高阶函数非常方便地实现命令模式。命令模式在 JavaScript语言中是一种隐形的模式。")])])}],e=t("2877"),p={},l=Object(e["a"])(p,r,n,!1,null,null,null);a["default"]=l.exports}}]);
//# sourceMappingURL=chunk-2d21ed26.076b3c05.js.map